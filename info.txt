using stcube ld file and following FLAGS, works with sprintf fine, however size is 4.4kb
stcube.ld needs to be modified by renaming _sidata to _la_data
compilation produces warnings:
_lseek is not implemented and will always fail
_write is not implemented and will always fail
warning: serial.elf has a LOAD segment with RWX permissions



CFLAGS= -c -mcpu=$(MACH) -mthumb -std=gnu11 -Wall -g -O0 --specs=nosys.specs

LDFLAGS=-mcpu=cortex-m3 -T stcubo.ld  --specs=nosys.specs -Wl,-Map="serial.map" -static --specs=nano.specs  -mfloat-abi=soft -Wl,--gc-sections  -mthumb -Wl,--start-group -lc -lm -Wl,--end-group



#lcd contrast
pot: 10k
contrast to ground: 360
contrast to vcc (3.3v): 9.4K
2018-11-18
#This is how much i remember:
#Arduino boot loader
1. Upload arduino boot loader /home/eimis/d5/progs/stm32f103t8c6/arduino_bootloader/generic_boot20_pc13_good.bin with stlink using stlink-gui.
2. Now Arduino programs can  be compiled and uploaded using Arduino ide via built in micro usb. In case of errors check usb permissions in udev rules. If uploading using root works - then definitely udev rules must be tweaked.
3. Enable flash upload verbose output in arduino ide - it will be possible to do uploading directly in bash.

2024-12-21
#writing
st-flash write ./blink.forblack.pb12.bin 0x08000000

St link use bin files for flashing.

Power consumption blinky: 3.3v 28mA
Arduino flashing does not work, neither via usb nor st-link.

Blue board built in led PC13
Black board built in led: PB12

2025-02-03
Black bluepill
PA12 Microusb + (pulled up with 1.5KOhm resistor to 3.3v)
PA11 Microusb -


2025-02-07
USART TC (transmission complete) interrupt is generated only when shift register is empty. When looping in a tight loop over a buffer and pushing to DR register a new byte whenever DR becomes free (checking SR->TXE bit), TC flag is not set, therefore no interrupt. 
